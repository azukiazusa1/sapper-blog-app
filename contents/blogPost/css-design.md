---
id: 2xUg9PKsDfhjav58MgFSvn
title: "CSSの設計"
slug: "css-design"
about: "今この文章を読んでいる人ならば、少なくともCSSには触れたことがあると思います。CSSはとても簡単に記述できますが、それゆえにCSSは「壊れやすい」のです。なぜCSSは壊れやすくなってしまうのでしょうか。CSSには「すべてがグローバルスコープ」「複雑化するWeb開発」といった問題点があげられます。そのような状態に対する解決策として、CSSの設計が誕生しました。"
createdAt: "2020-09-13T00:00+09:00"
updatedAt: "2020-09-13T00:00+09:00"
tags: ["CSS"]
published: true
---
# はじめに

今この文章を読んでいる人ならば、少なくともCSSには触れたことがあると思います。
CSSはとても簡単に記述できますが、それゆえにCSSは「壊れやすい」のです。

# CSSの問題点

なぜCSSは壊れやすくなってしまうのでしょうか。
CSSには以下のような問題点があげられます。

- すべてがグローバルスコープ
- 複雑化するWeb開発

## すべてがグローバルスコープ

ある程度のプログラミングの経験がある方なら、この一行だけでことの重大さがわかるでしょう。CSSは読み込まれたスタイリングのすべてが適用されます。

互いのスタイリングが干渉しあって、なぜかスタイリングが適用されないのでやむなく`!important`する、スタイルを変更したら想定外の箇所に影響が及んでしまったなどの経験があるのではないでしょうか？

[shadow DOM](https://developer.mozilla.org/ja/docs/Web/Web_Components/Using_shadow_DOM)によるスタイルのスコープ化という手段もありますが、まだすべてのブラウザでサポートをしているわけではありません。

## 複雑化するWeb開発

CSSが日本で使われるようになったのが2002年頃ですが、当時と比べてWeb開発の場面は大きく異なっています。

「見出しがあって、続く本文があって、その中にさらに小見出しがあって・・・」という文書的な使われ方が一般的でしたが、いまやコンテンツをアニメーションしたり、ユーザーの操作に合わせて表示させる内容を切り替えるなど、リッチなWebアプリケーションが当たり前のように求められるようになりました。

数百ページに及ぶWebサイト、頻繁に変更される状態など、さまざまな要素が複雑に絡み合っており、CSS提唱当時には想定されていなかったような進化をしているため、CSSの管理が追いつかない状態になってしまっています。

# CSS設計の誕生

そのような状態に対する解決策として、CSSの設計が誕生しました。今までも会社・個人単位でCSSを管理する工夫は行われていましたが、以下のような問題点がありました。

- 規則をきちんと整理できていないと、一人で開発を行うときですら記述にブレが生じる
- ドキュメント化されていないと、他社と協力して作業を行う際に記述にブレが生じる
- 考えが甘すぎて、そもそも規則として機能しない
- 新たにプロジェクトに参画した際に学習コストが生じる

既存の優れたCSS設計を適用することで、このような問題点を解決することができます。

CSS設計の有名所では、以下があげられます。

- OOCSS
- BEM
- SMACSS
- FLOCSS

# CSS設計の共通の考え方

CSSの設計思想には、以下の4つの考え方が共通して存在しているといえます。

- 予測しやすい(可読性)
- 再利用しやすい(再利用性)
- 保守しやすい(メンテナンス性)
- 拡張しやすい(拡張性)

## 予測しやすい(可読性)

機能追加・見た目の変更・修正を行う際に「どのスタイルが変更されるのか」または「どのスタイルは変更されないのか」が理解できる状態。

## 再利用しやすい（再利用性)

汎用的なスタイルは，定義したCSSの形を変えずに，どのような場合でも複数箇所で使い回すことができる状態。

## 保守としやすい(メンテナンス性）

既存のCSSのリファクタリングをできるだけ行わずに，新しい見た目や機能を追加できる状態。

## 拡張しやすい（拡張性）

機能の追加・修正などの拡張をすることを前提として，他のどの開発者がアサインされたとしても低学習コストでソースコードを理解し，サイトの拡張ができる状態。

それでは、代表的なCSSの設計を簡単に紹介していきます。

# OOCSS (Object Oriented CSS)

[http://oocss.org/](http://oocss.org/)

OOCSSはObject Oriented CSS（オブジェクト指向CSS）の略で、名前通りスタイリングにオブジェクトを指向を取り入れた設計です。OOCSSの歴史はかなり古く、明確に規則と呼べるものも多くはありませんが、後続のCSSの設計に大きな影響を与えました。

レゴのように自由に組み合わせる部品をつくり、マルチクラスの設計になります。

OOCSSの目的としているところは以下の通りです。

1. ストラクチャーとスキンの分離
2. コンテナとコンテンツの分離

##  ストラクチャーとスキンの分離

「ストラクチャー」はインターフェースが持つ不変的な形を定義し，「⁠スキン」はそのまま、その都度変わる固有の見た目を定義します。

例えばボタンという部品の基本形となるスタイルを定義して、色や大きさなどの見た目を定義するスタイルを後から付け加えるようにして再利用がしやすいようになっています。

「ストラクチャー」はオブジェクト指向におけるインターフェースで、「スキン」がインターフェースを継承したクラス、と当てはめることができるでしょう。

## コンテナとコンテンツの分離

コンテナは大まかに「エリア」、コンテンツはボタンなどの「モジュール」が当てはまります。

コンテンツはなるべく再利用できるように設計するので、特定のエリアに依存しないようにスタイリングをします。そのため、IDセレクターのような詳細なセレクターは使用しません。

一方でコンテナに対してはレイアウトに対するスタイリングを行い、例えばグリッドレイアウトなどでコンテンツを配置していきます。

# BEM（Block Element Modifier）

[https://en.bem.info/](https://en.bem.info/)

BEMは、他の設計手法に比べて厳格で、独特な命名規則を用いることで有名です。世界的にもOOCSSに匹敵するほど名前が知られています。

BEM（Block Element Modifier）の名前の通り、モジュールをBlock、Element、Modifierに分けて分解し定義していきます。

大まかに、分類するとBlockはヘッダー、ナビゲーションなどの大きな括り、ElementはBlockの中のボタンなどの要素、Modifier部品の見た目や状態の変更に用いられます。

BEMでは、クラスセレクターの使用が基本となり、要素型セレクターやIDセレクターの使用は推奨されていません。また、詳細度を均一に保つことでModifierやMixによる上書きをしやすくしています。

また、**Block__Element--Modifier**という命名規則に従ってクラス名がつけられます。

例えば、ヘッダーの中に小さなボタンを配置する場合、次のようなクラス名がつけられます。

```html
header__button--small
```

さらに、Modifier名は省略してはいけないという規則があります。例えば、上記の例でBlockとElementを省略した`.small`というクラスを作成したくなりますが、名前の衝突・どのクラスに対するModifireなのか見分けがつかない・コードが検索しづらいなどの理由から数章されていません。

そのため、クラス名が長くなってしまうという欠点もあります。

規則が少し緩やかになった、MindBEMdingと呼ばれるものが登場し、こちらの命名規則が現在主流となっています。

# SMACSS（Scalable and Modular Architecture for CSS）

[https://smacss.com/](https://smacss.com/)

SMACSSはScalable and Modular Architecture for CSS（拡張可能でモジュール的なCSS設計）の略です。
OOCSSと同じくマルチクラスでスタイルを適用します。

SMACSSの特徴は、CSSのコードを役割に応じて以下の5つにカテゴライズしたことです。

- ベース
- レイアウト
- モジュール
- 状態（ステート）
- テーマ

## ベース

ベースはプロジェクトの表示のスタイルを定義します。body要素に背景色を設定する、aタグのスタイルを設定するなどを行います。
また、リセットCSSを使用する場合もベースルールとして含めます。

## レイアウト

レイアウトは、ヘッダーやフッター、メインエリアなどの大枠を構成するものに対するものです。レイアウトルールでは、ページ内に一度しか使用されないことが多いので、IDセレクターによるスタイリングが許容されています。

また、レイアウトルールにおいてクラスセレクターを使用する際には`l-`という接頭辞をつけることが推奨されています。

## モジュール

モジュールはレイアウトの中で使用されるボタンなどの再利用可能な部品です。
モジュールには接頭辞をつけません。

## 状態（ステート）

ステートはエラー、アクティブなどの状態を表すスタイリングです。状態スタイルはレイアウトやモジュールに割り当てることができ、JavaScriptに依存します。

例えば、入力フォームでバリエーションエラーが発生した際には、JavaScriptでそれに該当するスタイリングを適用することが求められます。

接頭辞には`is-`が用いられます。

## テーマ

最後にテーマルールです。サイト内のレイアウトや色を上書きする際に使用されます。ライトテーマとダークテーマを入れ替えるようなケースがわかりやすいでしょう。

接頭辞には`theme-`を使用します。

# FLOCSS（Foundation Layout Object CSS）

[https://github.com/hiloki/flocss](https://github.com/hiloki/flocss)

最後に、FLOCSSです。FLOCSSは日本人によって作成されており、ドキュメントも日本語で参照することが可能です。

OOCSSやSMACSS、BEMなどのコンセプトを取り入れた設計思想で、SMACSSの様なレイヤー構成とBEMの命名規則を採用しています。こちらもマルチクラスでスタイルを適用させます。

FLOCSSは次の3つのレイヤーと、Objectレイヤーの子レイヤーで構成されます。

- Foundation
- Layout
- Object
  - Component
  - Project 
  - Utility 

## Foundation

SMACSSのベースと同じくプロジェクトの基本的なスタイルを適用します。

## Layout

ページを構成するヘッダー、フッター、メインエリアなどのスタイルを定義します。
こちらも同じくIDセレクタの使用が許容され、クラスセレクタを使用する場合には`l-`の接頭辞を使用します。

SMACSSとの違いとして、グリッドレイアウトのためのモジュールはObject/Componentレイヤーとして定義します。

## Object

オブジェクトはOOCSSに従い、再利用可能なジュアルパターンをすべてObjectと定義します。
Objectはさらに次の3つのレイヤーに分けられます。

- Component
- Project
- Utility

### Component

ComponentはObjectの中で最も小さな単位のモジュールです。ボタンなどが相当します。
これはAtomic DesignにおけるAtomに相当するもとの考えられます。

`c-`の接頭辞が使用されます。

### Project

プロジェクト固有のパターンであり、いくつかのComponentが集まって構成されます。
例えば、記事一覧や、ユーザープロフィール、画像ギャラリーなどコンテンツを構成する要素などが該当します。

`p-`の接頭辞が使用されます。

### Utility

Utilityはいわゆるヘルパークラスに相当します。

`u-`の接頭辞が使用されます。

## 命名規則

命名規則は基本的にMindBEMdingのアイディア取り入れています。

さらに、Modifierの命名の派生パターンとしてJavaScriptで操作されるスタイルには`-is`接頭辞を与えることができます。

## おわりに

CSSの設計がなぜ必要なのかと代表的なCSSの設計を見てきました。

さらにCSSの開発を効率化してくれるツールや、スタイルガイドジェネレーターなど触れていない箇所も多くあります。

「なんとなくCSSを書いていた」状態から、「しっかりとCSSを設計できる」状態に切り替えられるようにしたいです。
